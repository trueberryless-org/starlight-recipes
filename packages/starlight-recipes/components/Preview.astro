---
import type { StarlightRecipeEntry } from "../libs/content";
import type { Locale } from "../libs/i18n";
import { getPathWithLocale, getRelativeUrl } from "../libs/page";

import Cover from "./Cover.astro";
import Excerpt from "./Excerpt.astro";
import Metadata from "./Metadata.astro";
import RecipeTags from "./RecipeTags.astro";
import Rating from "./Rating.astro";

interface Props {
  entry: StarlightRecipeEntry;
  locale: Locale;
}

const { entry, locale } = Astro.props;
---

<article class="preview">
  <header>
    <h2>
      <a href={getRelativeUrl(`/${getPathWithLocale(entry.id, locale)}`)}
        >{entry.data.title}</a
      >
    </h2>
    {entry.data.cover && <Cover cover={entry.data.cover} />}

    <div class="metadata-wrapper">
      <Metadata entry={entry} {locale} />
      <Rating recipeId={entry.id} />
    </div>
  </header>
  {
    entry.data.excerpt && (
      <div class="sl-markdown-content">
        <Excerpt {entry} />
      </div>
    )
  }
  <footer>
    <RecipeTags {entry} {locale} />
  </footer>
</article>

<style>
  .preview {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  h2 {
    margin-bottom: 1.5rem;
  }

  h2 a {
    text-decoration: none;
  }

  .metadata-wrapper {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }
</style>
